<?xml version="1.0" encoding="utf-8"?>
<Page x:Class="MiraiPalette.WinUI.Views.SettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:MiraiPalette.WinUI.Views"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:controls="using:CommunityToolkit.WinUI.Controls"
      xmlns:ui="using:CommunityToolkit.WinUI"
      xmlns:localization="using:MiraiPalette.WinUI.Strings"
      xmlns:settings="using:MiraiPalette.WinUI.Settings"
      xmlns:converters="using:MiraiPalette.WinUI.Converters"
      xmlns:helpers="using:MiraiPalette.WinUI.Helpers"
      xmlns:globalization="using:System.Globalization"
      NavigationCacheMode="Required"
      mc:Ignorable="d">
    <Page.Resources>
        <converters:ThemeValueToNameConverter x:Name="ThemeValueToNameConverter" />
        <converters:LanguageCodeToNameConverter x:Name="LanguageCodeToNameConverter" /> 
    </Page.Resources>
    <Grid Padding="32">
        <ScrollViewer Padding="8">
            <StackPanel Orientation="Vertical" Spacing="8">
                <Rectangle Height="64"/>
                <TextBlock Text="{x:Bind localization:SettingsPageStrings.AppearanceAndBehavior,Mode=OneTime}"
                           Style="{ThemeResource BodyStrongTextBlockStyle}"/>
                <controls:SettingsCard 
                    HeaderIcon="{ui:FontIcon Glyph=&#xE790;}" 
                    Header="{x:Bind localization:SettingsPageStrings.AppTheme_Header,Mode=OneTime}" 
                    Description="{x:Bind localization:SettingsPageStrings.AppTheme_Description,Mode=OneTime}">
                    <ComboBox SelectedItem="{x:Bind ViewModel.ThemeMode,Mode=TwoWay,Converter={StaticResource ThemeValueToNameConverter}}"
                              ItemsSource="{x:Bind ViewModel.ThemeModeOptions,Mode=OneTime}" />
                </controls:SettingsCard>
                <TextBlock Text="{x:Bind localization:SettingsPageStrings.LanguageAndRegion,Mode=OneTime}"                          
                           Style="{ThemeResource BodyStrongTextBlockStyle}" />
                <controls:SettingsCard Header="{x:Bind localization:SettingsPageStrings.Language_Header,Mode=OneTime}"
                                       HeaderIcon="{ui:FontIcon Glyph=&#xF2B7;}"
                                       Description="{x:Bind localization:SettingsPageStrings.Language_Description,Mode=OneTime}">
                    <ComboBox SelectedItem="{x:Bind ViewModel.Language,Mode=TwoWay,Converter={StaticResource LanguageCodeToNameConverter}}"
                              ItemsSource="{x:Bind ViewModel.LanguageOptions,Mode=OneTime}" />
                </controls:SettingsCard>
                <TextBlock Text="{x:Bind localization:SettingsPageStrings.About,Mode=OneTime}"
                           Style="{ThemeResource BodyStrongTextBlockStyle}" />
                <controls:SettingsExpander Header="Mirai Palette"
                                           HeaderIcon="{ui:BitmapIcon Source=ms-appx:///Assets/MiraiPaletteLogo.ico}"
                                           Description="© 2025 RemeaMiku. All rights reserved">
                    <TextBlock IsTextSelectionEnabled="True" Text="{x:Bind ViewModel.Version,Mode=OneTime}" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    <controls:SettingsExpander.Items>
                        <controls:SettingsCard Header="{x:Bind localization:SettingsPageStrings.DependenciesAndReferences,Mode=OneTime}" HorizontalContentAlignment="Left" ContentAlignment="Vertical">
                            <StackPanel Orientation="Vertical"
                                        Spacing="4">
                                <HyperlinkButton Content="Windows App SDK"
                                                 NavigateUri="{x:Bind helpers:BindHelper.ToFormattedUri('https://learn.microsoft.com/{0}/windows/apps/windows-app-sdk', globalization:CultureInfo.CurrentUICulture.Name),Mode=OneTime}" />
                                <HyperlinkButton Content="WinUI 3"
                                                 NavigateUri="{x:Bind helpers:BindHelper.ToFormattedUri('https://learn.microsoft.com/{0}/windows/apps/winui/winui3', globalization:CultureInfo.CurrentUICulture.Name),Mode=OneTime}" />
                                <HyperlinkButton Content="Microsoft Fluent Design"
                                                 NavigateUri="https://fluent2.microsoft.design/" />
                                <HyperlinkButton Content=".NET Community Toolkit"
                                                 NavigateUri="{x:Bind helpers:BindHelper.ToFormattedUri('https://learn.microsoft.com/{0}/dotnet/communitytoolkit/introduction', globalization:CultureInfo.CurrentUICulture.Name),Mode=OneTime}" />
                                <HyperlinkButton Content="Windows Community Toolkit"
                                                 NavigateUri="{x:Bind helpers:BindHelper.ToFormattedUri('https://learn.microsoft.com/{0}/dotnet/communitytoolkit/windows/', globalization:CultureInfo.CurrentUICulture.Name),Mode=OneTime}" />
                            </StackPanel>
                        </controls:SettingsCard>
                    </controls:SettingsExpander.Items>
                </controls:SettingsExpander>
                <Rectangle Height="64"/>
            </StackPanel>
        </ScrollViewer>
        <Border CornerRadius="{ThemeResource ControlCornerRadius}" Padding="16" Background="{ThemeResource DefaultAcrylicBrush}" VerticalAlignment="Top">
            <TextBlock Text="{x:Bind localization:SettingsPageStrings.Title,Mode=OneTime}"
                       Style="{ThemeResource TitleTextBlockStyle}" />
        </Border>
        <InfoBar VerticalAlignment="Bottom" 
                 Title="{x:Bind localization:SettingsPageStrings.NeedRestart,Mode=OneTime}"
                 Severity="Informational"
                 IsClosable="False"
                 IsOpen="{x:Bind ViewModel.NeedRestartForChanges,Mode=OneWay}" Background="{ThemeResource DefaultAcrylicBrush}" />
    </Grid>
</Page>
